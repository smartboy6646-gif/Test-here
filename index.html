<!DOCTYPE html>
<html lang="ne">
<head>
  <meta charset="UTF-8" />
  <title>Happy Propose Day ‚ù§Ô∏è</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.60.0/phaser.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Parisienne&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; padding: 0; background: #000; overflow: hidden; font-family: 'Poppins', sans-serif; }
    #gameContainer { width: 100vw; height: 100vh; }
    
    /* ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§¨‡§ü‡§® */
    #overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.9);
        display: flex; flex-direction: column;
        align-items: center; justify-content: center;
        z-index: 999; cursor: pointer;
    }
    .heart-btn {
        font-size: 80px; animation: pulse 1.2s infinite;
    }
    .text-tap { 
        color: white; font-size: 18px; margin-top: 10px; border: 1px solid #ff4d6d; 
        padding: 10px 20px; border-radius: 20px; background: rgba(255, 77, 109, 0.2);
    }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
  </style>
</head>
<body>

<div id="overlay" onclick="startExperience()">
    <div class="heart-btn">üíå</div>
    <div class="text-tap">Click Here to Open ‚ù§Ô∏è</div>
    <div style="color: #bbb; margin-top: 10px; font-size: 12px;">(Sound On üîä)</div>
</div>

<div id="gameContainer"></div>

<script>
// --- ‡§∏‡•á‡§ü‡§ø‡§ô‡•ç‡§π‡§∞‡•Ç ---
const CONFIG = {
    // ‡§´‡•ã‡§ü‡•ã‡§ï‡•ã ‡§≤‡§ø‡§ô‡•ç‡§ï (‡§Ö‡§®‡§≤‡§æ‡§á‡§® ‡§≤‡§ø‡§ô‡•ç‡§ï ‡§∞‡§æ‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§≤‡§æ, ‡§ï‡§Æ‡•ç‡§™‡•ç‡§Ø‡•Å‡§ü‡§∞‡§ï‡•ã 'C:/Users...' ‡§≤‡•á ‡§ï‡§æ‡§Æ ‡§ó‡§∞‡•ç‡§¶‡•à‡§®)
    photoUrl: 'https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?ixlib=rb-4.0.3&w=800&q=80',
    // GitHub ‡§Æ‡§æ song.mp3 ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ó‡§∞‡•ç‡§®‡•Å‡§≠‡§è‡§ï‡•ã ‡§õ ‡§≠‡§®‡•á ‡§Ø‡§π‡•Ä ‡§†‡•Ä‡§ï ‡§õ
    musicUrl: 'song.mp3' 
};

let game;

function startExperience() {
    document.getElementById('overlay').style.display = 'none';
    const config = {
        type: Phaser.AUTO,
        parent: 'gameContainer',
        width: window.innerWidth,
        height: window.innerHeight,
        backgroundColor: '#1a1a2e',
        scale: { mode: Phaser.Scale.RESIZE, autoCenter: Phaser.Scale.CENTER_BOTH },
        scene: MainScene
    };
    game = new Phaser.Game(config);
}

class MainScene extends Phaser.Scene {
    constructor() { super('MainScene'); }

    preload() {
        this.load.image('userPhoto', CONFIG.photoUrl);
        this.load.audio('bgm', CONFIG.musicUrl);
    }

    create() {
        const w = this.scale.width;
        const h = this.scale.height;

        // ‡•ß. ‡§¨‡•ç‡§Ø‡§æ‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§®‡•ç‡§°
        const graphics = this.add.graphics();
        graphics.fillGradientStyle(0x2c0e37, 0x2c0e37, 0x000000, 0x000000, 1);
        graphics.fillRect(0, 0, w, h);

        // ‡•®. ‡§Æ‡•ç‡§Ø‡•Å‡§ú‡§ø‡§ï
        try {
            this.sound.pauseOnBlur = false;
            const music = this.sound.add('bgm', { volume: 0.6, loop: true });
            music.play();
        } catch(e) { console.log("Music error"); }

        // ‡•©. ‡§™‡§æ‡§∞‡•ç‡§ü‡§ø‡§ï‡§≤‡•ç‡§∏ (Particles)
        this.add.particles(0, 0, this.createDot(), {
            x: { min: 0, max: w }, y: h + 20,
            speedY: { min: -40, max: -90 },
            scale: { start: 0.6, end: 0 },
            lifespan: 5000,
            quantity: 2,
            blendMode: 'ADD',
            tint: [0xff4d6d, 0xffffff]
        });

        // ‡•™. ‡§Æ‡•Å‡§ü‡•Å ‡§∏‡•Å‡§∞‡•Å‡§Æ‡§æ
        this.heart = this.add.text(w/2, h/2 - 60, '‚ù§Ô∏è', { fontSize: '80px' })
            .setOrigin(0.5).setAlpha(0);

        this.startSequence();
    }

    createDot() {
        const dot = this.make.graphics({x:0, y:0, add:false});
        dot.fillStyle(0xffffff).fillCircle(5, 5, 5);
        dot.generateTexture('dot', 10, 10);
        return 'dot';
    }

    startSequence() {
        this.tweens.add({
            targets: this.heart, scale: 1.2, alpha: 1, duration: 1000, ease: 'Back.Out',
            onComplete: () => {
                this.tweens.add({ targets: this.heart, scale: 1.4, duration: 600, yoyo: true, repeat: -1 });
                this.showText();
            }
        });
    }

    showText() {
        const messages = [
            "‡§§‡§ø‡§Æ‡•Ä ‡§Æ‡•á‡§∞‡•ã ‡§ú‡•Ä‡§µ‡§®‡§ï‡•ã ‡§∏‡•Å‡§®‡•ç‡§¶‡§∞ ‡§â‡§™‡§π‡§æ‡§∞ ‡§π‡•å...",
            "‡§ú‡§∏‡§ï‡•ã ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§®‡§Æ‡§æ ‡§Æ‡•á‡§∞‡•ã ‡§∏‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§∞ ‡§õ",
            "‡§§‡§ø‡§Æ‡•ç‡§∞‡•ã ‡§∏‡§æ‡§• ‡§¨‡§ø‡§®‡§æ ‡§Ø‡•ã ‡§Æ‡•Å‡§ü‡•Å ‡§Ö‡§ß‡•Å‡§∞‡•ã ‡§õ",
            "‡§π‡§∞‡•á‡§ï ‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§Æ‡•ç‡§∞‡•à ‡§≠‡§è‡§∞ ‡§¨‡§æ‡§Å‡§ö‡•ç‡§® ‡§ö‡§æ‡§π‡§®‡•ç‡§õ‡•Å",
            "‡§§‡§ø‡§Æ‡•Ä‡§≤‡§æ‡§à ‡§∏‡§ß‡•à‡§Ç ‡§ñ‡•Å‡§∏‡•Ä ‡§∞‡§æ‡§ñ‡•ç‡§®‡•á ‡§µ‡§æ‡§ö‡§æ ‡§ó‡§∞‡•ç‡§õ‡•Å",
            "Happy Propose Day, My Everything ‚ù§Ô∏è",
            "üíñ I LOVE YOU SANCHITA BUDI üíñ"
        ];

        let delay = 0;
        let txt = null; // Variable Fixed Here

        messages.forEach((m, i) => {
            this.time.delayedCall(delay, () => {
                // ‡§™‡•Å‡§∞‡§æ‡§®‡•ã ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§π‡§ü‡§æ‡§â‡§®‡•á
                if(txt) {
                    this.tweens.add({ targets: txt, alpha: 0, y: txt.y - 40, duration: 600 });
                }

                // ‡§´‡§®‡•ç‡§ü ‡§∏‡§æ‡§á‡§ú ‡§†‡•Å‡§≤‡•ã ‡§¨‡§®‡§æ‡§â‡§®‡•á ‡§´‡§∞‡•ç‡§Æ‡•Å‡§≤‡§æ
                const size = Math.min(45, (this.scale.width - 20) / m.length * 2.2);

                txt = this.add.text(this.scale.width/2, this.scale.height/2 + 100, m, {
                    fontSize: size + 'px', 
                    fill: '#fff', 
                    align: 'center', 
                    fontStyle: 'bold',
                    wordWrap: { width: this.scale.width - 30 },
                    stroke: '#ff4d6d', 
                    strokeThickness: 3, 
                    shadow: { blur: 15, color: '#ff4d6d', fill: true }
                }).setOrigin(0.5).setAlpha(0);

                // ‡§®‡§Ø‡§æ‡§Å ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¶‡•á‡§ñ‡§æ‡§â‡§®‡•á
                this.tweens.add({ targets: txt, alpha: 1, y: this.scale.height/2 + 80, duration: 800 });

                // ‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ‡§Æ‡§æ ‡§´‡•ã‡§ü‡•ã ‡§¶‡•á‡§ñ‡§æ‡§â‡§®‡•á
                if(i === messages.length - 1) {
                    this.time.delayedCall(3500, () => this.revealPhoto(txt));
                }
            });
            delay += 3000;
        });
    } // ‡§Ø‡§π‡§æ‡§Å ‡§¨‡•ç‡§∞‡•ç‡§Ø‡§æ‡§ï‡•á‡§ü ‡§õ‡•Å‡§ü‡•á‡§ï‡•ã ‡§•‡§ø‡§Ø‡•ã, ‡§Ö‡§¨ ‡§´‡§ø‡§ï‡•ç‡§∏ ‡§≠‡§Ø‡•ã

    revealPhoto(lastText) {
        // ‡§Æ‡•Å‡§ü‡•Å ‡§∞ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§≤‡•Å‡§ï‡§æ‡§â‡§®‡•á
        this.tweens.add({ targets: [this.heart, lastText], alpha: 0, duration: 1000 });

        const cx = this.scale.width / 2;
        const cy = this.scale.height / 2;
        const size = Math.min(this.scale.width, this.scale.height) * 0.7; // ‡§´‡•ã‡§ü‡•ã ‡§∏‡§æ‡§á‡§ú

        const container = this.add.container(cx, cy).setAlpha(0).setScale(0.5);

        // ‡§∏‡•á‡§§‡•ã ‡§¨‡•ã‡§∞‡•ç‡§°‡§∞
        const bg = this.add.rectangle(0, 0, size + 20, size + 70, 0xffffff);
        
        // ‡§´‡•ã‡§ü‡•ã ‡§≤‡•ã‡§° ‡§≠‡§Ø‡•ã ‡§ï‡§ø ‡§≠‡§è‡§® ‡§ö‡•á‡§ï ‡§ó‡§∞‡•ç‡§®‡•á
        let img;
        if(this.textures.exists('userPhoto')) {
            img = this.add.image(0, -20, 'userPhoto').setDisplaySize(size, size);
        } else {
            // ‡§´‡•ã‡§ü‡•ã ‡§≤‡•ã‡§° ‡§®‡§≠‡§è ‡§ï‡§æ‡§≤‡•ã ‡§¨‡§ï‡•ç‡§∏
            img = this.add.rectangle(0, -20, size, size, 0x222222);
            const err = this.add.text(0,-20, "Photo Loading...", {color:'white'}).setOrigin(0.5);
            container.add(err);
        }

        const caption = this.add.text(0, size/2 + 10, "Forever & Always", {
            fontFamily: 'Parisienne', fontSize: '24px', color: '#000', fontStyle: 'bold'
        }).setOrigin(0.5);

        container.add([bg, img, caption]);

        // Flash Effect
        const flash = this.add.rectangle(0, 0, this.scale.width, this.scale.height, 0xffffff).setOrigin(0).setAlpha(0);
        
        this.tweens.add({
            targets: flash, alpha: 1, duration: 200, yoyo: true,
            onComplete: () => {
                this.tweens.add({
                    targets: container,
                    alpha: 1, scale: 1, rotation: 0.05,
                    duration: 1500, ease: 'Power2.Out'
                });
            }
        });
    }
}
</script>
</body>
</html>
